<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fit GLMMs â€¢ spatiotemporaldynamics</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fit GLMMs">
<meta property="og:description" content="spatiotemporaldynamics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spatiotemporaldynamics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01_Visualise_Data.html">Visualise data</a>
    </li>
    <li>
      <a href="../articles/a02_Fit_GLMMs.html">Fit GLMMs</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="a02_Fit_GLMMs_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fit GLMMs</h1>
                        <h4 class="author">Ihsan Khaliq</h4>
            
            <h4 class="date">2021-07-15</h4>
      
      
      <div class="hidden name"><code>a02_Fit_GLMMs.Rmd</code></div>

    </div>

    
    
<div id="load-libraries" class="section level3">
<h3 class="hasAnchor">
<a href="#load-libraries" class="anchor"></a>Load libraries</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://readxl.tidyverse.org">"readxl"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://lubridate.tidyverse.org">"lubridate"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"spatiotemporaldynamics"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://www.rforge.net/SDMTools/">"SDMTools"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/glmmTMB/glmmTMB">"glmmTMB"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://florianhartig.github.io/DHARMa/">"DHARMa"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"gridExtra"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/ggpubr/">"ggpubr"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://here.r-lib.org/">"here"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://strengejacke.github.io/ggeffects/">"ggeffects"</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="import-disease-spread-data" class="section level3">
<h3 class="hasAnchor">
<a href="#import-disease-spread-data" class="anchor"></a>Import disease spread data</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### import spatiotemporal spread data</span>
<span class="va">dat</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"SpatioTemporalSpreadData_N.xlsx"</span>,
                package <span class="op">=</span> <span class="st">"spatiotemporaldynamics"</span><span class="op">)</span>,
    sheet <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></code></pre></div>
<pre><code>##    location         assessment_date               assessment_number
##  Length:1800        Min.   :2020-07-02 00:00:00   Min.   : 1.000   
##  Class :character   1st Qu.:2020-08-13 00:00:00   1st Qu.: 3.000   
##  Mode  :character   Median :2020-09-10 00:00:00   Median : 5.000   
##                     Mean   :2020-09-08 21:20:00   Mean   : 5.056   
##                     3rd Qu.:2020-10-09 00:00:00   3rd Qu.: 7.000   
##                     Max.   :2020-11-05 00:00:00   Max.   :10.000   
##   plot_number      distance      quadrat           direction        
##  Min.   :1.00   Min.   :0.00   Length:1800        Length:1800       
##  1st Qu.:1.75   1st Qu.:3.00   Class :character   Class :character  
##  Median :2.50   Median :6.00   Mode  :character   Mode  :character  
##  Mean   :2.50   Mean   :5.76                                        
##  3rd Qu.:3.25   3rd Qu.:9.00                                        
##  Max.   :4.00   Max.   :9.00                                        
##  infected_plants   total_plants     incidence         min_temp     
##  Min.   : 0.000   Min.   :16.00   Min.   :  0.00   Min.   : 2.943  
##  1st Qu.: 0.000   1st Qu.:36.00   1st Qu.:  0.00   1st Qu.: 4.421  
##  Median : 0.000   Median :44.00   Median :  0.00   Median : 7.633  
##  Mean   : 8.672   Mean   :43.53   Mean   : 19.30   Mean   : 8.052  
##  3rd Qu.: 4.000   3rd Qu.:51.00   3rd Qu.: 11.51   3rd Qu.:11.350  
##  Max.   :74.000   Max.   :74.00   Max.   :100.00   Max.   :15.580  
##     max_temp        avg_temp     avg_wind_speed    total_rain   
##  Min.   :18.19   Min.   :10.57   Min.   :1.524   Min.   : 0.00  
##  1st Qu.:19.98   1st Qu.:12.16   1st Qu.:1.752   1st Qu.: 1.00  
##  Median :25.81   Median :16.72   Median :2.468   Median : 4.80  
##  Mean   :24.13   Mean   :16.09   Mean   :2.506   Mean   :12.16  
##  3rd Qu.:27.47   3rd Qu.:19.35   3rd Qu.:3.024   3rd Qu.:20.80  
##  Max.   :29.24   Max.   :21.71   Max.   :3.507   Max.   :57.40  
##      min_rh          max_rh          avg_rh     
##  Min.   :14.57   Min.   :63.64   Min.   :39.11  
##  1st Qu.:25.69   1st Qu.:75.38   1st Qu.:50.54  
##  Median :34.60   Median :81.25   Median :58.70  
##  Mean   :31.88   Mean   :80.59   Mean   :56.23  
##  3rd Qu.:36.92   3rd Qu.:85.93   3rd Qu.:60.81  
##  Max.   :47.56   Max.   :89.81   Max.   :68.69</code></pre>
</div>
<div id="import-daily-average-wind-direction-data" class="section level3">
<h3 class="hasAnchor">
<a href="#import-daily-average-wind-direction-data" class="anchor"></a>Import daily average wind direction data</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wind</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"DailyWindDirectionData.xlsx"</span>,
                package <span class="op">=</span> <span class="st">"spatiotemporaldynamics"</span><span class="op">)</span>,
    sheet <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">wind</span><span class="op">)</span></code></pre></div>
<pre><code>##      date             location         assessment_number
##  Length:247         Length:247         Min.   : 1.000   
##  Class :character   Class :character   1st Qu.: 3.000   
##  Mode  :character   Mode  :character   Median : 5.000   
##                                        Mean   : 4.798   
##                                        3rd Qu.: 7.000   
##                                        Max.   :10.000   
##  daily_avg_wind_direction
##  Length:247              
##  Class :character        
##  Mode  :character        
##                          
##                          
## </code></pre>
</div>
<div id="convert-text-to-degrees" class="section level3">
<h3 class="hasAnchor">
<a href="#convert-text-to-degrees" class="anchor"></a>Convert text to degrees</h3>
<p>Wind direction for the Billa Billa site is the character format recorded as the text value of the wind direction. We need to convert it to degrees for calculations and then calculate the fortnightly average wind direction for use in the GLMMs.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wind</span> <span class="op">&lt;-</span>
  <span class="va">wind</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>wind_degrees <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"N"</span> <span class="op">~</span> <span class="st">"0"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NbE"</span> <span class="op">~</span> <span class="st">"11.25"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NNE"</span> <span class="op">~</span> <span class="st">"22.5"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NEbN"</span> <span class="op">~</span> <span class="st">"33.75"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NE"</span> <span class="op">~</span> <span class="st">"45"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NEbE"</span> <span class="op">~</span> <span class="st">"56.25"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"ENE"</span> <span class="op">~</span> <span class="st">"67.5"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"EbN"</span> <span class="op">~</span> <span class="st">"73.5"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"E"</span> <span class="op">~</span> <span class="st">"90"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"EbS"</span> <span class="op">~</span> <span class="st">"101.2"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"ESE"</span> <span class="op">~</span> <span class="st">"112.5"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SEbE"</span> <span class="op">~</span> <span class="st">"123.8"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SE"</span> <span class="op">~</span> <span class="st">"135.1"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SEbS"</span> <span class="op">~</span> <span class="st">"146.3"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SSE"</span> <span class="op">~</span> <span class="st">"157.6"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SbE"</span> <span class="op">~</span> <span class="st">"168.8"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"S"</span> <span class="op">~</span> <span class="st">"180"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SbW"</span> <span class="op">~</span> <span class="st">"191.2"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SSW"</span> <span class="op">~</span> <span class="st">"202.5"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SWbS"</span> <span class="op">~</span> <span class="st">"213.8"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SW"</span> <span class="op">~</span> <span class="st">"225"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SWbW"</span> <span class="op">~</span> <span class="st">"236.2"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"WSW"</span> <span class="op">~</span> <span class="st">"247.5"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"WbS"</span> <span class="op">~</span> <span class="st">"258.8"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"W"</span> <span class="op">~</span> <span class="st">"270"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"WbN"</span> <span class="op">~</span> <span class="st">"281.2"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"WNW"</span> <span class="op">~</span> <span class="st">"292.5"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NWbW"</span> <span class="op">~</span> <span class="st">"303.8"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NW"</span> <span class="op">~</span> <span class="st">"315"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NWbN"</span> <span class="op">~</span> <span class="st">"326.2"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NNW"</span> <span class="op">~</span> <span class="st">"337.5"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NbW"</span> <span class="op">~</span> <span class="st">"348.8"</span>,
      <span class="cn">TRUE</span> <span class="op">~</span>   <span class="va">daily_avg_wind_direction</span>
    <span class="op">)</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">location</span>, <span class="va">assessment_number</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>wind_direction <span class="op">=</span> <span class="fu"><a href="../reference/circular.averaging.html">circular.averaging</a></span><span class="op">(</span><span class="va">wind_degrees</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="join-the-wind-direction-and-disease-spread-data" class="section level3">
<h3 class="hasAnchor">
<a href="#join-the-wind-direction-and-disease-spread-data" class="anchor"></a>Join the wind direction and disease spread data</h3>
<p>Left-join the wind and disease data for analysis in the GLMMs.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">wind</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"location"</span>, <span class="st">"assessment_number"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="combine-quadrat-direction-and-location-columns" class="section level3">
<h3 class="hasAnchor">
<a href="#combine-quadrat-direction-and-location-columns" class="anchor"></a>Combine quadrat direction and location columns</h3>
<p>This is required to determine whether quadrats located in particular direction around the primary infection foci has a significantly faster disease progress rates, which in turn will inform us about directional disease spread by wind direction</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span>
  <span class="fu">unite</span><span class="op">(</span><span class="va">dat</span>, <span class="va">quadrat_direc</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">location</span>, <span class="va">direction</span><span class="op">)</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </code></pre></div>
</div>
<div id="examine-data" class="section level3">
<h3 class="hasAnchor">
<a href="#examine-data" class="anchor"></a>Examine data</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></code></pre></div>
<pre><code>## tibble [1,800 Ã— 20] (S3: tbl_df/tbl/data.frame)
##  $ quadrat_direc    : chr [1:1800] "Billa Billa_All" "Billa Billa_North" "Billa Billa_NorthEast" "Billa Billa_East" ...
##  $ location         : chr [1:1800] "Billa Billa" "Billa Billa" "Billa Billa" "Billa Billa" ...
##  $ assessment_date  : POSIXct[1:1800], format: "2020-07-02" "2020-07-02" ...
##  $ assessment_number: num [1:1800] 1 1 1 1 1 1 1 1 1 1 ...
##  $ plot_number      : num [1:1800] 1 1 1 1 1 1 1 1 1 1 ...
##  $ distance         : num [1:1800] 0 9 9 9 9 9 9 9 9 6 ...
##  $ quadrat          : chr [1:1800] "F" "N9" "NE9" "E9" ...
##  $ direction        : chr [1:1800] "All" "North" "NorthEast" "East" ...
##  $ infected_plants  : num [1:1800] 0 0 0 0 0 0 0 0 0 0 ...
##  $ total_plants     : num [1:1800] 36 48 27 57 53 41 39 31 36 54 ...
##  $ incidence        : num [1:1800] 0 0 0 0 0 0 0 0 0 0 ...
##  $ min_temp         : num [1:1800] 3.99 3.99 3.99 3.99 3.99 ...
##  $ max_temp         : num [1:1800] 20 20 20 20 20 ...
##  $ avg_temp         : num [1:1800] 12 12 12 12 12 ...
##  $ avg_wind_speed   : num [1:1800] 1.52 1.52 1.52 1.52 1.52 ...
##  $ total_rain       : num [1:1800] 1 1 1 1 1 1 1 1 1 1 ...
##  $ min_rh           : num [1:1800] 35.2 35.2 35.2 35.2 35.2 ...
##  $ max_rh           : num [1:1800] 82.7 82.7 82.7 82.7 82.7 ...
##  $ avg_rh           : num [1:1800] 58.9 58.9 58.9 58.9 58.9 ...
##  $ wind_direction   : num [1:1800] 88.5 88.5 88.5 88.5 88.5 ...</code></pre>
</div>
<div id="convert-data-to-correct-classes-for-analyses" class="section level3">
<h3 class="hasAnchor">
<a href="#convert-data-to-correct-classes-for-analyses" class="anchor"></a>Convert data to correct classes for analyses</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cols_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"location"</span>, <span class="st">"quadrat"</span>, <span class="st">"direction"</span>, <span class="st">"quadrat_direc"</span><span class="op">)</span>
<span class="va">dat</span><span class="op">[</span><span class="va">cols_1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span><span class="va">cols_1</span><span class="op">]</span>, <span class="va">factor</span><span class="op">)</span>
<span class="va">cols_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"infected_plants"</span>, <span class="st">"total_plants"</span><span class="op">)</span>
<span class="va">dat</span><span class="op">[</span><span class="va">cols_2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span><span class="va">cols_2</span><span class="op">]</span>, <span class="va">as.integer</span><span class="op">)</span>
<span class="va">dat</span><span class="op">$</span><span class="va">assessment_number</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">assessment_number</span><span class="op">)</span></code></pre></div>
</div>
<div id="re-check-class" class="section level3">
<h3 class="hasAnchor">
<a href="#re-check-class" class="anchor"></a>Re-check class</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">class</span><span class="op">)</span></code></pre></div>
<pre><code>## $quadrat_direc
## [1] "factor"
## 
## $location
## [1] "factor"
## 
## $assessment_date
## [1] "POSIXct" "POSIXt" 
## 
## $assessment_number
## [1] "factor"
## 
## $plot_number
## [1] "numeric"
## 
## $distance
## [1] "numeric"
## 
## $quadrat
## [1] "factor"
## 
## $direction
## [1] "factor"
## 
## $infected_plants
## [1] "integer"
## 
## $total_plants
## [1] "integer"
## 
## $incidence
## [1] "numeric"
## 
## $min_temp
## [1] "numeric"
## 
## $max_temp
## [1] "numeric"
## 
## $avg_temp
## [1] "numeric"
## 
## $avg_wind_speed
## [1] "numeric"
## 
## $total_rain
## [1] "numeric"
## 
## $min_rh
## [1] "numeric"
## 
## $max_rh
## [1] "numeric"
## 
## $avg_rh
## [1] "numeric"
## 
## $wind_direction
## [1] "numeric"</code></pre>
</div>
<div id="set-seed-number-for-reproducibility-purposes" class="section level3">
<h3 class="hasAnchor">
<a href="#set-seed-number-for-reproducibility-purposes" class="anchor"></a>Set seed number for reproducibility purposes</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></code></pre></div>
</div>
<div id="fit-models" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-models" class="anchor"></a>Fit models</h2>
<div id="mod1" class="section level3">
<h3 class="hasAnchor">
<a href="#mod1" class="anchor"></a>Mod1</h3>
<p>Use glmms to include different assessment dates/assessment numbers as random effects since they were not independent. That is, disease assessment conducted at a later assessment date was dependent on the amount of disease present in the former assessment date. Density plots show the data is over-dispersed. It should be noted that over-dispersion is due to excess zeros, especially at the beginning, which in turn is attributed to low level of inoculum/rain. That is, excess zeros explains biological phenomena, and we donâ€™t want to control for over-dispersion. Rather we are interested in making inferences about over-dispersion as a component of ecological process. The use of quasipoisson family, which fits an extra parameter that allows variance is greater than mean, allows to make such inferences</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod1</span> <span class="op">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span>
      <span class="va">infected_plants</span> <span class="op">~</span> <span class="va">total_rain</span> <span class="op">+</span> <span class="va">avg_rh</span> <span class="op">+</span> <span class="va">avg_temp</span> <span class="op">+</span> <span class="va">avg_wind_speed</span> <span class="op">+</span> <span class="va">distance</span>  <span class="op">+</span> <span class="va">location</span> <span class="op">+</span>  <span class="op">(</span><span class="fl">1</span> <span class="op">|</span><span class="va">assessment_number</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">total_plants</span><span class="op">)</span><span class="op">)</span>,
      family <span class="op">=</span> <span class="va">nbinom1</span>,
      data <span class="op">=</span> <span class="va">dat</span>
   <span class="op">)</span>
                                                                  
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></code></pre></div>
<pre><code>##  Family: nbinom1  ( log )
## Formula:          
## infected_plants ~ total_rain + avg_rh + avg_temp + avg_wind_speed +  
##     distance + location + (1 | assessment_number) + offset(log(total_plants))
## Data: dat
## 
##      AIC      BIC   logLik deviance df.resid 
##   6006.3   6055.8  -2994.1   5988.3     1791 
## 
## Random effects:
## 
## Conditional model:
##  Groups            Name        Variance Std.Dev.
##  assessment_number (Intercept) 0.5217   0.7223  
## Number of obs: 1800, groups:  assessment_number, 10
## 
## Dispersion parameter for nbinom1 family (): 17.8 
## 
## Conditional model:
##                 Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    -8.185745   2.339532  -3.499 0.000467 ***
## total_rain      0.036044   0.006726   5.359 8.38e-08 ***
## avg_rh         -0.053244   0.030215  -1.762 0.078040 .  
## avg_temp        0.245412   0.064261   3.819 0.000134 ***
## avg_wind_speed  1.793736   0.765363   2.344 0.019097 *  
## distance       -0.121322   0.011881 -10.212  &lt; 2e-16 ***
## locationTosari -0.706097   1.013913  -0.696 0.486174    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>The predictor <code>quadrat_direc</code> had to be dropped from the model because the model failed to converge. There is not enough data for the mixed model to include all predictors.</p>
</div>
<div id="mod2-interaction-bw-wind-speed-direction" class="section level3">
<h3 class="hasAnchor">
<a href="#mod2-interaction-bw-wind-speed-direction" class="anchor"></a>Mod2 (Interaction b/w wind speed &amp; direction)</h3>
<p>Estimate for Tosari is negative and relative humidity has a negative effect, which doesnâ€™t make any biological sense. This means that an important predictor is missing. Try interaction between wind direction and relative humidity</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod2</span> <span class="op">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span>
      <span class="va">infected_plants</span> <span class="op">~</span> <span class="va">total_rain</span> <span class="op">+</span> <span class="va">avg_rh</span> <span class="op">+</span> <span class="va">wind_direction</span> <span class="op">+</span> <span class="va">avg_rh</span> <span class="op">*</span> <span class="va">wind_direction</span>  <span class="op">+</span> <span class="va">avg_wind_speed</span> <span class="op">+</span> <span class="va">avg_temp</span> <span class="op">+</span> <span class="va">distance</span> <span class="op">+</span> <span class="va">location</span> <span class="op">+</span>
         <span class="op">(</span><span class="fl">1</span> <span class="op">|</span>  <span class="va">assessment_number</span><span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://rdrr.io/r/stats/offset.html">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">total_plants</span><span class="op">)</span><span class="op">)</span>,
      family <span class="op">=</span> <span class="va">nbinom1</span>,
      data <span class="op">=</span> <span class="va">dat</span>
   <span class="op">)</span></code></pre></div>
<pre><code>## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/
## NaN function evaluation

## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/
## NaN function evaluation

## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/
## NaN function evaluation</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></code></pre></div>
<pre><code>##  Family: nbinom1  ( log )
## Formula:          
## infected_plants ~ total_rain + avg_rh + wind_direction + avg_rh *  
##     wind_direction + avg_wind_speed + avg_temp + distance + location +  
##     (1 | assessment_number) + offset(log(total_plants))
## Data: dat
## 
##      AIC      BIC   logLik deviance df.resid 
##   5995.8   6056.3  -2986.9   5973.8     1789 
## 
## Random effects:
## 
## Conditional model:
##  Groups            Name        Variance Std.Dev.
##  assessment_number (Intercept) 0.1146   0.3385  
## Number of obs: 1800, groups:  assessment_number, 10
## 
## Dispersion parameter for nbinom1 family (): 17.7 
## 
## Conditional model:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)           -8.2713695  2.4201991  -3.418 0.000632 ***
## total_rain             0.0258358  0.0055283   4.673 2.96e-06 ***
## avg_rh                -0.0566833  0.0419450  -1.351 0.176576    
## wind_direction         0.0476796  0.0162605   2.932 0.003365 ** 
## avg_wind_speed        -0.3278659  0.7843401  -0.418 0.675936    
## avg_temp               0.4517809  0.0677108   6.672 2.52e-11 ***
## distance              -0.1210635  0.0118714 -10.198  &lt; 2e-16 ***
## locationTosari         1.7025641  0.9816155   1.734 0.082838 .  
## avg_rh:wind_direction -0.0006676  0.0002812  -2.374 0.017579 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>It can be seen that significant negative effect of relative humidity has been removed with a significant negative interaction between wind speed and wind direction</p>
</div>
<div id="mod3-remove-wind-speed" class="section level3">
<h3 class="hasAnchor">
<a href="#mod3-remove-wind-speed" class="anchor"></a>Mod3 (Remove wind speed)</h3>
<p>Remove wind speed due to its very p-large value</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod3</span> <span class="op">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span>
      <span class="va">infected_plants</span> <span class="op">~</span> <span class="va">total_rain</span> <span class="op">+</span> <span class="va">wind_direction</span> <span class="op">+</span> <span class="va">avg_rh</span> <span class="op">*</span> <span class="va">wind_direction</span> <span class="op">+</span>  <span class="va">avg_temp</span> <span class="op">+</span> <span class="va">distance</span> <span class="op">+</span> <span class="va">location</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">assessment_number</span><span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://rdrr.io/r/stats/offset.html">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">total_plants</span><span class="op">)</span><span class="op">)</span>,
      family <span class="op">=</span> <span class="va">nbinom1</span>,
      data <span class="op">=</span> <span class="va">dat</span>
   <span class="op">)</span></code></pre></div>
<pre><code>## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/
## NaN function evaluation

## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/
## NaN function evaluation

## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/
## NaN function evaluation</code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></code></pre></div>
<pre><code>##  Family: nbinom1  ( log )
## Formula:          
## infected_plants ~ total_rain + wind_direction + avg_rh * wind_direction +  
##     avg_temp + distance + location + (1 | assessment_number) +  
##     offset(log(total_plants))
## Data: dat
## 
##      AIC      BIC   logLik deviance df.resid 
##     5994     6049    -2987     5974     1790 
## 
## Random effects:
## 
## Conditional model:
##  Groups            Name        Variance Std.Dev.
##  assessment_number (Intercept) 0.1206   0.3473  
## Number of obs: 1800, groups:  assessment_number, 10
## 
## Dispersion parameter for nbinom1 family (): 17.7 
## 
## Conditional model:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)           -8.7572435  2.1071427  -4.156 3.24e-05 ***
## total_rain             0.0266117  0.0052455   5.073 3.91e-07 ***
## wind_direction         0.0462245  0.0158854   2.910  0.00362 ** 
## avg_rh                -0.0502772  0.0387946  -1.296  0.19498    
## avg_temp               0.4268845  0.0321457  13.280  &lt; 2e-16 ***
## distance              -0.1210855  0.0118713 -10.200  &lt; 2e-16 ***
## locationTosari         1.3116098  0.2822845   4.646 3.38e-06 ***
## wind_direction:avg_rh -0.0006571  0.0002800  -2.347  0.01894 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div id="compare-models" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-models" class="anchor"></a>Compare models</h2>
<div id="anova" class="section level3">
<h3 class="hasAnchor">
<a href="#anova" class="anchor"></a>ANOVA</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="va">mod2</span>, <span class="va">mod3</span><span class="op">)</span></code></pre></div>
<pre><code>## Data: dat
## Models:
## mod1: infected_plants ~ total_rain + avg_rh + avg_temp + avg_wind_speed + , zi=~0, disp=~1
## mod1:     distance + location + (1 | assessment_number) + offset(log(total_plants)), zi=~0, disp=~1
## mod3: infected_plants ~ total_rain + wind_direction + avg_rh * wind_direction + , zi=~0, disp=~1
## mod3:     avg_temp + distance + location + (1 | assessment_number) + , zi=~0, disp=~1
## mod3:     offset(log(total_plants)), zi=~0, disp=~1
## mod2: infected_plants ~ total_rain + avg_rh + wind_direction + avg_rh * , zi=~0, disp=~1
## mod2:     wind_direction + avg_wind_speed + avg_temp + distance + location + , zi=~0, disp=~1
## mod2:     (1 | assessment_number) + offset(log(total_plants)), zi=~0, disp=~1
##      Df    AIC    BIC  logLik deviance   Chisq Chi Df Pr(&gt;Chisq)    
## mod1  9 6006.3 6055.8 -2994.2   5988.3                              
## mod3 10 5994.0 6049.0 -2987.0   5974.0 14.2728      1  0.0001581 ***
## mod2 11 5995.8 6056.3 -2986.9   5973.8  0.1723      1  0.6780770    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>Mod3 explains significant variations.</p>
</div>
</div>
<div id="marginal-effects-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#marginal-effects-plots" class="anchor"></a>Marginal effects plots</h2>
<p>Remove offset to make prediction for the current number of plants. Retaining them result in very low y-axis values</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">both_mod3</span> <span class="op">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span>
      <span class="va">infected_plants</span> <span class="op">~</span> <span class="va">total_rain</span> <span class="op">+</span> <span class="va">wind_direction</span> <span class="op">+</span> <span class="va">avg_rh</span> <span class="op">*</span> <span class="va">wind_direction</span> <span class="op">+</span>  <span class="va">avg_temp</span> <span class="op">+</span> <span class="va">distance</span> <span class="op">+</span> <span class="va">location</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">assessment_number</span><span class="op">)</span>,
      family <span class="op">=</span> <span class="va">nbinom1</span>,
      data <span class="op">=</span> <span class="va">dat</span>
   <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">both_mod3</span><span class="op">)</span></code></pre></div>
<pre><code>##  Family: nbinom1  ( log )
## Formula:          
## infected_plants ~ total_rain + wind_direction + avg_rh * wind_direction +  
##     avg_temp + distance + location + (1 | assessment_number)
## Data: dat
## 
##      AIC      BIC   logLik deviance df.resid 
##   6048.1   6103.0  -3014.0   6028.1     1790 
## 
## Random effects:
## 
## Conditional model:
##  Groups            Name        Variance Std.Dev.
##  assessment_number (Intercept) 0.1024   0.32    
## Number of obs: 1800, groups:  assessment_number, 10
## 
## Dispersion parameter for nbinom1 family (): 19.9 
## 
## Conditional model:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)           -4.8652202  2.0375264  -2.388  0.01695 *  
## total_rain             0.0259736  0.0050761   5.117 3.11e-07 ***
## wind_direction         0.0454646  0.0154196   2.949  0.00319 ** 
## avg_rh                -0.0503654  0.0376683  -1.337  0.18120    
## avg_temp               0.4179769  0.0306028  13.658  &lt; 2e-16 ***
## distance              -0.1241880  0.0123742 -10.036  &lt; 2e-16 ***
## locationTosari         1.5613457  0.2765233   5.646 1.64e-08 ***
## wind_direction:avg_rh -0.0006457  0.0002712  -2.381  0.01729 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>Make plots for individual predictors and combine them using <code>gridExtra</code> package</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">both_mod3</span> , <span class="st">"total_rain"</span><span class="op">)</span><span class="op">)</span>
<span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">both_mod3</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"avg_rh"</span>, <span class="st">"wind_direction"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">f3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">both_mod3</span> , <span class="st">"avg_temp"</span><span class="op">)</span><span class="op">)</span>
<span class="va">f4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">both_mod3</span>, <span class="st">"distance"</span><span class="op">)</span><span class="op">)</span>
<span class="va">f5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">both_mod3</span>, <span class="st">"wind_direction"</span><span class="op">)</span><span class="op">)</span>
<span class="va">fig_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">f1</span>, <span class="va">f2</span>, <span class="va">f3</span>, <span class="va">f4</span>, <span class="va">f5</span><span class="op">)</span></code></pre></div>
<p><img src="a02_Fit_GLMMs_files/figure-html/plot-predictions-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig_5</span></code></pre></div>
<pre><code>## TableGrob (3 x 2) "arrange": 5 grobs
##   z     cells    name           grob
## 1 1 (1-1,1-1) arrange gtable[layout]
## 2 2 (1-1,2-2) arrange gtable[layout]
## 3 3 (2-2,1-1) arrange gtable[layout]
## 4 4 (2-2,2-2) arrange gtable[layout]
## 5 5 (3-3,1-1) arrange gtable[layout]</code></pre>
</div>
<div id="model-diagnostics" class="section level2">
<h2 class="hasAnchor">
<a href="#model-diagnostics" class="anchor"></a>Model diagnostics</h2>
<div id="check-residuals-significance" class="section level3">
<h3 class="hasAnchor">
<a href="#check-residuals-significance" class="anchor"></a>Check residuals significance</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/DHARMa/man/simulateResiduals.html">simulateResiduals</a></span><span class="op">(</span><span class="va">mod3</span>, plot <span class="op">=</span> <span class="cn">T</span>, quantreg<span class="op">=</span><span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="a02_Fit_GLMMs_files/figure-html/tosari-billa-billa-1.png" width="672" style="display: block; margin: auto;"></p>
<pre><code>## Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
##  
## Scaled residual values: 0.07218306 0.6503369 0.8940689 0.1368317 0.758629 0.2132113 0.7425183 0.1585707 0.1243184 0.2005616 0.1686062 0.8710129 0.07444707 0.364408 0.2818884 0.2019707 0.6495531 0.3774864 0.3617681 0.6932231 ...</code></pre>
<p>Significant DHARMa tests alert indicate that there COULD be a problem. A likely reason could be the large number of observations (n=1800). DHARMa tests are usually significant for the last number of observations because some deviations from observations are inevitable in a large scale study. It might also be possible that an important predictors is missing. The weather station used in this study didnâ€™t record <code>dew points</code>. Future studies should aim to include <code>dew points</code> as a predictor.</p>
</div>
<div id="check-overall-performance" class="section level3">
<h3 class="hasAnchor">
<a href="#check-overall-performance" class="anchor"></a>Check overall performance</h3>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">mod3</span>, panel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="a02_Fit_GLMMs_files/figure-html/over-all-performance-1.png" width="672" style="display: block; margin: auto;"><img src="a02_Fit_GLMMs_files/figure-html/over-all-performance-2.png" width="672" style="display: block; margin: auto;"><img src="a02_Fit_GLMMs_files/figure-html/over-all-performance-3.png" width="672" style="display: block; margin: auto;"><img src="a02_Fit_GLMMs_files/figure-html/over-all-performance-4.png" width="672" style="display: block; margin: auto;"></p>
<p>There is moderate collinearity between relative humidity and wind direction, but since both are not directly related, both predictors have been included in the model. Here is the <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/j.1600-0587.2012.07348.x">reference</a></p>
</div>
<div id="check-heteroscedasticity" class="section level3">
<h3 class="hasAnchor">
<a href="#check-heteroscedasticity" class="anchor"></a>Check heteroscedasticity</h3>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_heteroscedasticity.html">check_heteroscedasticity</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>No heteroscedasticity detected</p>
</div>
<div id="check-for-zero-inflation" class="section level3">
<h3 class="hasAnchor">
<a href="#check-for-zero-inflation" class="anchor"></a>Check for zero-inflation</h3>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/DHARMa/man/testZeroInflation.html">testZeroInflation</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></code></pre></div>
<p><img src="a02_Fit_GLMMs_files/figure-html/check-zero-inflation-1.png" width="672" style="display: block; margin: auto;"></p>
<pre><code>## 
##  DHARMa zero-inflation test via comparison to expected zeros with
##  simulation under H0 = fitted model
## 
## data:  simulationOutput
## ratioObsSim = 1.0339, p-value = 0.352
## alternative hypothesis: two.sided</code></pre>
<p>No zero-inflation detected</p>
</div>
</div>
<div id="colophon" class="section level2">
<h2 class="hasAnchor">
<a href="#colophon" class="anchor"></a>Colophon</h2>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.1.0 (2021-05-18)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Catalina 10.15.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_AU.UTF-8/en_AU.UTF-8/en_AU.UTF-8/C/en_AU.UTF-8/en_AU.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] ggeffects_1.1.0              here_1.0.1                  
##  [3] ggpubr_0.4.0                 gridExtra_2.3               
##  [5] DHARMa_0.4.2                 glmmTMB_1.1.1               
##  [7] SDMTools_1.1-221             spatiotemporaldynamics_1.0.0
##  [9] lubridate_1.7.10             forcats_0.5.1               
## [11] stringr_1.4.0                dplyr_1.0.7                 
## [13] purrr_0.3.4                  readr_1.4.0                 
## [15] tidyr_1.1.3                  tibble_3.1.2                
## [17] ggplot2_3.3.5                tidyverse_1.3.1             
## [19] readxl_1.3.1                
## 
## loaded via a namespace (and not attached):
##   [1] minqa_1.2.4         colorspace_2.0-2    ggsignif_0.6.2     
##   [4] ggridges_0.5.3      ellipsis_0.3.2      rio_0.5.27         
##   [7] sjlabelled_1.1.8    rprojroot_2.0.2     parameters_0.14.0  
##  [10] fs_1.5.0            rstudioapi_0.13     farver_2.1.0       
##  [13] fansi_0.5.0         xml2_1.3.2          codetools_0.2-18   
##  [16] splines_4.1.0       R.methodsS3_1.8.1   doParallel_1.0.16  
##  [19] robustbase_0.93-8   cachem_1.0.5        knitr_1.33         
##  [22] jsonlite_1.7.2      nloptr_1.2.2.2      broom_0.7.8        
##  [25] dbplyr_2.1.1        R.oo_1.24.0         effectsize_0.4.5   
##  [28] shiny_1.6.0         compiler_4.1.0      httr_1.4.2         
##  [31] backports_1.2.1     assertthat_0.2.1    Matrix_1.3-3       
##  [34] fastmap_1.1.0       cli_3.0.0           later_1.2.0        
##  [37] htmltools_0.5.1.1   tools_4.1.0         gtable_0.3.0       
##  [40] glue_1.4.2          Rcpp_1.0.6          carData_3.0-4      
##  [43] cellranger_1.1.0    jquerylib_0.1.4     pkgdown_1.6.1      
##  [46] vctrs_0.3.8         nlme_3.1-152        iterators_1.0.13   
##  [49] insight_0.14.2      xfun_0.24           openxlsx_4.2.4     
##  [52] lme4_1.1-27.1       rvest_1.0.0         mime_0.11          
##  [55] lifecycle_1.0.0     rstatix_0.7.0       DEoptimR_1.0-9     
##  [58] MASS_7.3-54         scales_1.1.1        promises_1.2.0.1   
##  [61] hms_1.1.0           parallel_4.1.0      qqplotr_0.0.5      
##  [64] TMB_1.7.20          yaml_2.2.1          curl_4.3.2         
##  [67] see_0.6.4           memoise_2.0.0       sass_0.4.0         
##  [70] stringi_1.6.2       bayestestR_0.10.0   highr_0.9          
##  [73] desc_1.3.0          gap_1.2.3-1         foreach_1.5.1      
##  [76] boot_1.3-28         zip_2.2.0           qgam_1.3.3         
##  [79] rlang_0.4.11        pkgconfig_2.0.3     evaluate_0.14      
##  [82] lattice_0.20-44     labeling_0.4.2      tidyselect_1.1.1   
##  [85] plyr_1.8.6          magrittr_2.0.1      R6_2.5.0           
##  [88] generics_0.1.0      DBI_1.1.1           mgcv_1.8-35        
##  [91] pillar_1.6.1        haven_2.4.1         foreign_0.8-81     
##  [94] withr_2.4.2         abind_1.4-5         performance_0.7.2  
##  [97] modelr_0.1.8        crayon_1.4.1        car_3.0-11         
## [100] utf8_1.2.1          rmarkdown_2.9       grid_4.1.0         
## [103] data.table_1.14.0   reprex_2.0.0        digest_0.6.27      
## [106] xtable_1.8-4        httpuv_1.6.1        numDeriv_2016.8-1.1
## [109] R.utils_2.10.1      munsell_0.5.0       bslib_0.2.5.1</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ihanul Khaliq, Grains Research and Development Corporation.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
