<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fit GAMs to Ascocyta blight spatiotemporal development data • spatiotemporaldynamics</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fit GAMs to Ascocyta blight spatiotemporal development data">
<meta property="og:description" content="spatiotemporaldynamics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spatiotemporaldynamics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Fit%20GLMMs.html">Fit GLMMs to Ascocyta blight spatiotemporal development data</a>
    </li>
    <li>
      <a href="../articles/Spatiotemporal_development_GAMs.html">Fit GAMs to Ascocyta blight spatiotemporal development data</a>
    </li>
    <li>
      <a href="../articles/Visualise%20data.html">Visualise spatiotemporal spread data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Spatiotemporal_development_GAMs_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fit GAMs to Ascocyta blight spatiotemporal development data</h1>
                        <h4 class="author">Ihsan Khaliq</h4>
            
            <h4 class="date">2021-05-17</h4>
      
      
      <div class="hidden name"><code>Spatiotemporal_development_GAMs.Rmd</code></div>

    </div>

    
    
<div id="load-libraries" class="section level2">
<h2 class="hasAnchor">
<a href="#load-libraries" class="anchor"></a>Load libraries</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://readxl.tidyverse.org">"readxl"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"mgcv"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://broom.tidymodels.org/">"broom"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/ggpubr/">"ggpubr"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://lubridate.tidyverse.org">"lubridate"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"spatiotemporaldynamics"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://www.rforge.net/SDMTools/">"SDMTools"</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="import-data" class="section level2">
<h2 class="hasAnchor">
<a href="#import-data" class="anchor"></a>Import data</h2>
<div id="disease-spread-data" class="section level3">
<h3 class="hasAnchor">
<a href="#disease-spread-data" class="anchor"></a>Disease spread data</h3>
<p>Import disease data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### import spatiotemporal spread data</span>
<span class="va">dat</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"SpatioTemporalSpreadData.xlsx"</span>,
                package <span class="op">=</span> <span class="st">"spatiotemporaldynamics"</span><span class="op">)</span>,
    sheet <span class="op">=</span> <span class="fl">1</span>,
    na <span class="op">=</span> <span class="st">"NA"</span>
  <span class="op">)</span></code></pre></div>
<pre><code>## Error: `path` does not exist: ''</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in summary(dat): object 'dat' not found</code></pre>
</div>
<div id="daily-average-wind-direction-data" class="section level3">
<h3 class="hasAnchor">
<a href="#daily-average-wind-direction-data" class="anchor"></a>Daily average wind direction data</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wind</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"DailyWindDirectionData.xlsx"</span>,
                  package <span class="op">=</span> <span class="st">"spatiotemporaldynamics"</span><span class="op">)</span>,
      sheet <span class="op">=</span> <span class="fl">1</span>
   <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">wind</span><span class="op">)</span></code></pre></div>
<pre><code>##      date             location         assessment_number
##  Length:247         Length:247         Min.   : 1.000   
##  Class :character   Class :character   1st Qu.: 3.000   
##  Mode  :character   Mode  :character   Median : 5.000   
##                                        Mean   : 4.798   
##                                        3rd Qu.: 7.000   
##                                        Max.   :10.000   
##  daily_avg_wind_direction
##  Length:247              
##  Class :character        
##  Mode  :character        
##                          
##                          
## </code></pre>
</div>
</div>
<div id="convert-text-to-degrees" class="section level2">
<h2 class="hasAnchor">
<a href="#convert-text-to-degrees" class="anchor"></a>Convert text to degrees</h2>
<p>Wind direction for the Billa Billa site is the character format recorded as the text value of the wind direction. We need to convert it to degrees for calculations and then calculate the fortnightly average wind direction for use in the GAMs.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wind</span> <span class="op">&lt;-</span>
  <span class="va">wind</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>wind_degrees <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span>
    <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"N"</span> <span class="op">~</span> <span class="st">"0"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NbE"</span> <span class="op">~</span> <span class="st">"11.25"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NNE"</span> <span class="op">~</span> <span class="st">"22.5"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NEbN"</span> <span class="op">~</span> <span class="st">"33.75"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NE"</span> <span class="op">~</span> <span class="st">"45"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NEbE"</span> <span class="op">~</span> <span class="st">"56.25"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"ENE"</span> <span class="op">~</span> <span class="st">"67.5"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"EbN"</span> <span class="op">~</span> <span class="st">"73.5"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"E"</span> <span class="op">~</span> <span class="st">"90"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"EbS"</span> <span class="op">~</span> <span class="st">"101.2"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"ESE"</span> <span class="op">~</span> <span class="st">"112.5"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SEbE"</span> <span class="op">~</span> <span class="st">"123.8"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SE"</span> <span class="op">~</span> <span class="st">"135.1"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SEbS"</span> <span class="op">~</span> <span class="st">"146.3"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SSE"</span> <span class="op">~</span> <span class="st">"157.6"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SbE"</span> <span class="op">~</span> <span class="st">"168.8"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"S"</span> <span class="op">~</span> <span class="st">"180"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SbW"</span> <span class="op">~</span> <span class="st">"191.2"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SSW"</span> <span class="op">~</span> <span class="st">"202.5"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SWbS"</span> <span class="op">~</span> <span class="st">"213.8"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SW"</span> <span class="op">~</span> <span class="st">"225"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"SWbW"</span> <span class="op">~</span> <span class="st">"236.2"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"WSW"</span> <span class="op">~</span> <span class="st">"247.5"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"WbS"</span> <span class="op">~</span> <span class="st">"258.8"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"W"</span> <span class="op">~</span> <span class="st">"270"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"WbN"</span> <span class="op">~</span> <span class="st">"281.2"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"WNW"</span> <span class="op">~</span> <span class="st">"292.5"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NWbW"</span> <span class="op">~</span> <span class="st">"303.8"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NW"</span> <span class="op">~</span> <span class="st">"315"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NWbN"</span> <span class="op">~</span> <span class="st">"326.2"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NNW"</span> <span class="op">~</span> <span class="st">"337.5"</span>,
      <span class="va">daily_avg_wind_direction</span> <span class="op">==</span> <span class="st">"NbW"</span> <span class="op">~</span> <span class="st">"348.8"</span>,
      <span class="cn">TRUE</span> <span class="op">~</span>   <span class="va">daily_avg_wind_direction</span>
    <span class="op">)</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">location</span>, <span class="va">assessment_number</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>wind_direction <span class="op">=</span> <span class="fu"><a href="../reference/circular.averaging.html">circular.averaging</a></span><span class="op">(</span><span class="va">wind_degrees</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by 'location'. You can override using the `.groups` argument.</code></pre>
</div>
<div id="join-the-data-sources" class="section level2">
<h2 class="hasAnchor">
<a href="#join-the-data-sources" class="anchor"></a>Join the data sources</h2>
<p>Left-join the wind and disease data for analysis in the GAMs.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">dat</span>, <span class="va">wind</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"location"</span>, <span class="st">"assessment_number"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in left_join(dat, wind, by = c("location", "assessment_number")): object 'dat' not found</code></pre>
<div id="combine-quadrat-direction-and-location-column-to-determine-whether-quadrats-located-in-particular-direction-has-significantly-faster-disease-progress-rates" class="section level3">
<h3 class="hasAnchor">
<a href="#combine-quadrat-direction-and-location-column-to-determine-whether-quadrats-located-in-particular-direction-has-significantly-faster-disease-progress-rates" class="anchor"></a>Combine quadrat direction and location column to determine whether quadrats located in particular direction has significantly faster disease progress rates</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span>
  <span class="fu">unite</span><span class="op">(</span><span class="va">dat</span>, <span class="va">direc_loc</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">location</span>, <span class="va">direction</span><span class="op">)</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </code></pre></div>
<pre><code>## Error in unite(dat, direc_loc, c(location, direction), remove = FALSE): object 'dat' not found</code></pre>
</div>
</div>
<div id="examine-data" class="section level2">
<h2 class="hasAnchor">
<a href="#examine-data" class="anchor"></a>Examine data</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in str(dat): object 'dat' not found</code></pre>
</div>
<div id="prepare-data-to-fit-gams" class="section level2">
<h2 class="hasAnchor">
<a href="#prepare-data-to-fit-gams" class="anchor"></a>Prepare data to fit GAMs</h2>
<p>Assign variables to the correct classes.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cols_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"location"</span>, <span class="st">"quadrat"</span>, <span class="st">"direction"</span>, <span class="st">"direc_loc"</span><span class="op">)</span>
<span class="va">dat</span><span class="op">[</span><span class="va">cols_1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span><span class="va">cols_1</span><span class="op">]</span>, <span class="va">factor</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in lapply(dat[cols_1], factor): object 'dat' not found</code></pre>
</div>
<div id="re-check-class" class="section level2">
<h2 class="hasAnchor">
<a href="#re-check-class" class="anchor"></a>Re-check class</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">class</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in lapply(X = X, FUN = FUN, ...): object 'dat' not found</code></pre>
</div>
<div id="fit-univariate-gams" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-univariate-gams" class="anchor"></a>Fit univariate GAMs</h2>
<p>Use <code><a href="https://rdrr.io/r/base/Random.html">set.seed()</a></code> for reproducibility purposes.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></code></pre></div>
<div id="model_1-sdistance" class="section level3">
<h3 class="hasAnchor">
<a href="#model_1-sdistance" class="anchor"></a>Model_1 s(distance)</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_1</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span><span class="op">(</span><span class="va">incidence</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">distance</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="va">dat</span>,
      method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in is.data.frame(data): object 'dat' not found</code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_1</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in summary(model_1): object 'model_1' not found</code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span>
  <span class="va">model_1</span>,
  pages <span class="op">=</span> <span class="fl">1</span>,
  residuals <span class="op">=</span> <span class="cn">TRUE</span>,
  shade <span class="op">=</span> <span class="cn">TRUE</span>,
  seWithMean <span class="op">=</span> <span class="cn">TRUE</span>,
  shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model_1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="op">)</span></code></pre></div>
<pre><code>## Error in plot(model_1, pages = 1, residuals = TRUE, shade = TRUE, seWithMean = TRUE, : object 'model_1' not found</code></pre>
</div>
<div id="model_2-stotal_rain" class="section level3">
<h3 class="hasAnchor">
<a href="#model_2-stotal_rain" class="anchor"></a>Model_2 s(total_rain)</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_2</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span><span class="op">(</span><span class="va">incidence</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">total_rain</span>, k <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="va">dat</span>,
      method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in is.data.frame(data): object 'dat' not found</code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_2</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in summary(model_2): object 'model_2' not found</code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span>
  <span class="va">model_2</span>,
  residuals <span class="op">=</span> <span class="cn">TRUE</span>,
  pages <span class="op">=</span> <span class="fl">1</span>,
  shade <span class="op">=</span> <span class="cn">TRUE</span>,
  seWithMean <span class="op">=</span> <span class="cn">TRUE</span>,
  shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model_2</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="op">)</span></code></pre></div>
<pre><code>## Error in plot(model_2, residuals = TRUE, pages = 1, shade = TRUE, seWithMean = TRUE, : object 'model_2' not found</code></pre>
</div>
<div id="model_3-assessment_number" class="section level3">
<h3 class="hasAnchor">
<a href="#model_3-assessment_number" class="anchor"></a>Model_3 assessment_number</h3>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_3</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span><span class="op">(</span><span class="va">incidence</span> <span class="op">~</span> <span class="va">assessment_number</span>,
      data <span class="op">=</span> <span class="va">dat</span>,
      method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in is.data.frame(data): object 'dat' not found</code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_3</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in summary(model_3): object 'model_3' not found</code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span>
  <span class="va">model_3</span>,
  all.terms <span class="op">=</span> <span class="cn">TRUE</span>,
  residuals <span class="op">=</span> <span class="cn">TRUE</span>,
  pages <span class="op">=</span> <span class="fl">1</span>,
  shade <span class="op">=</span> <span class="cn">TRUE</span>,
  seWithMean <span class="op">=</span> <span class="cn">TRUE</span>,
  shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model_3</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>## Error in plot(model_3, all.terms = TRUE, residuals = TRUE, pages = 1, : object 'model_3' not found</code></pre>
</div>
<div id="model_4-savg_wind_speed" class="section level3">
<h3 class="hasAnchor">
<a href="#model_4-savg_wind_speed" class="anchor"></a>Model_4 s(avg_wind_speed)</h3>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_4</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span><span class="op">(</span><span class="va">incidence</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">avg_wind_speed</span>, k <span class="op">=</span> <span class="fl">18</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="va">dat</span>,
      method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in is.data.frame(data): object 'dat' not found</code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_4</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in summary(model_4): object 'model_4' not found</code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span>
  <span class="va">model_4</span>,
  residuals <span class="op">=</span> <span class="cn">TRUE</span>,
  pages <span class="op">=</span> <span class="fl">1</span>,
  shade <span class="op">=</span> <span class="cn">TRUE</span>,
  seWithMean <span class="op">=</span> <span class="cn">TRUE</span>,
  shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model_4</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="op">)</span></code></pre></div>
<pre><code>## Error in plot(model_4, residuals = TRUE, pages = 1, shade = TRUE, seWithMean = TRUE, : object 'model_4' not found</code></pre>
</div>
<div id="model_5-savg_rh" class="section level3">
<h3 class="hasAnchor">
<a href="#model_5-savg_rh" class="anchor"></a>Model_5 s(avg_rh)</h3>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_5</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span><span class="op">(</span><span class="va">incidence</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">avg_rh</span>, k <span class="op">=</span> <span class="fl">18</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="va">dat</span>,
      method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in is.data.frame(data): object 'dat' not found</code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_5</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in summary(model_5): object 'model_5' not found</code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">model_5</span>,
     residuals <span class="op">=</span> <span class="cn">TRUE</span>,
     pages <span class="op">=</span> <span class="fl">1</span>,
     shade <span class="op">=</span> <span class="cn">TRUE</span>,
  seWithMean <span class="op">=</span> <span class="cn">TRUE</span>,
  shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model_5</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in plot(model_5, residuals = TRUE, pages = 1, shade = TRUE, seWithMean = TRUE, : object 'model_5' not found</code></pre>
</div>
<div id="model_6-savg-_temp" class="section level3">
<h3 class="hasAnchor">
<a href="#model_6-savg-_temp" class="anchor"></a>Model_6 s(avg _temp)</h3>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_6</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span><span class="op">(</span><span class="va">incidence</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">avg_temp</span>, k <span class="op">=</span> <span class="fl">18</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="va">dat</span>,
      method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in is.data.frame(data): object 'dat' not found</code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_6</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in summary(model_6): object 'model_6' not found</code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span>
  <span class="va">model_6</span>,
  residuals <span class="op">=</span> <span class="cn">TRUE</span>,
  pages <span class="op">=</span> <span class="fl">1</span>,
  shade <span class="op">=</span> <span class="cn">TRUE</span>,
  seWithMean <span class="op">=</span> <span class="cn">TRUE</span>,
  shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model_6</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="op">)</span></code></pre></div>
<pre><code>## Error in plot(model_6, residuals = TRUE, pages = 1, shade = TRUE, seWithMean = TRUE, : object 'model_6' not found</code></pre>
</div>
<div id="model_6-1-savg-_temp-by-location" class="section level3">
<h3 class="hasAnchor">
<a href="#model_6-1-savg-_temp-by-location" class="anchor"></a>Model_6.1 s(avg _temp, by = location)</h3>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_6.1</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span><span class="op">(</span><span class="va">incidence</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">avg_temp</span>, by <span class="op">=</span> <span class="va">location</span>, k <span class="op">=</span> <span class="fl">18</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="va">dat</span>,
      method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in is.data.frame(data): object 'dat' not found</code></pre>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_6.1</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in summary(model_6.1): object 'model_6.1' not found</code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span>
  <span class="va">model_6.1</span>,
  residuals <span class="op">=</span> <span class="cn">TRUE</span>,
  pages <span class="op">=</span> <span class="fl">1</span>,
  shade <span class="op">=</span> <span class="cn">TRUE</span>,
  seWithMean <span class="op">=</span> <span class="cn">TRUE</span>,
  shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model_6.1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="op">)</span></code></pre></div>
<pre><code>## Error in plot(model_6.1, residuals = TRUE, pages = 1, shade = TRUE, seWithMean = TRUE, : object 'model_6.1' not found</code></pre>
</div>
<div id="model_7-location" class="section level3">
<h3 class="hasAnchor">
<a href="#model_7-location" class="anchor"></a>Model_7 location</h3>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_7</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span><span class="op">(</span><span class="va">incidence</span> <span class="op">~</span> <span class="va">location</span>,
      data <span class="op">=</span> <span class="va">dat</span>,
      method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in is.data.frame(data): object 'dat' not found</code></pre>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_7</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in summary(model_7): object 'model_7' not found</code></pre>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span>
  <span class="va">model_7</span>,
  residuals <span class="op">=</span> <span class="cn">TRUE</span>,
  all.terms <span class="op">=</span> <span class="cn">TRUE</span>,
  pages <span class="op">=</span> <span class="fl">1</span>,
  shade <span class="op">=</span> <span class="cn">TRUE</span>,
  seWithMean <span class="op">=</span> <span class="cn">TRUE</span>,
  shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model_7</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="op">)</span></code></pre></div>
<pre><code>## Error in plot(model_7, residuals = TRUE, all.terms = TRUE, pages = 1, : object 'model_7' not found</code></pre>
</div>
</div>
<div id="fit-multivariate-gams" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-multivariate-gams" class="anchor"></a>Fit multivariate GAMs</h2>
<div id="model_8-all-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#model_8-all-variables" class="anchor"></a>Model_8 (All variables)</h3>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_8</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span><span class="op">(</span>
    <span class="va">incidence</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">total_rain</span>, k <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">distance</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">avg_wind_speed</span>, k <span class="op">=</span> <span class="fl">18</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">avg_rh</span>, k <span class="op">=</span> <span class="fl">18</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">avg_temp</span>, k <span class="op">=</span> <span class="fl">18</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">wind_direction</span>, k <span class="op">=</span> <span class="fl">18</span><span class="op">)</span> <span class="op">+</span>
      <span class="va">location</span> <span class="op">+</span>
      <span class="va">assessment_number</span> <span class="op">+</span>
      <span class="va">direc_loc</span>,
    data <span class="op">=</span> <span class="va">dat</span>,
    method <span class="op">=</span> <span class="st">"REML"</span>
  <span class="op">)</span></code></pre></div>
<pre><code>## Error in is.data.frame(data): object 'dat' not found</code></pre>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_8</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in summary(model_8): object 'model_8' not found</code></pre>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span>
  <span class="va">model_8</span>,
  pages <span class="op">=</span> <span class="fl">1</span>,
  shade <span class="op">=</span> <span class="cn">TRUE</span>,
  seWithMean <span class="op">=</span> <span class="cn">TRUE</span>,
  shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model_8</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="op">)</span></code></pre></div>
<pre><code>## Error in plot(model_8, pages = 1, shade = TRUE, seWithMean = TRUE, shift = coef(model_8)[1]): object 'model_8' not found</code></pre>
</div>
<div id="model_9-fit-different-smooths-for-each-term-by-location" class="section level3">
<h3 class="hasAnchor">
<a href="#model_9-fit-different-smooths-for-each-term-by-location" class="anchor"></a>Model_9 (Fit different smooths for each term by location)</h3>
<p>Same as <code>model_8</code> but different smooths have been considered for each term BY LOCATION</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_9</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span><span class="op">(</span>
    <span class="va">incidence</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">total_rain</span>, k <span class="op">=</span> <span class="fl">16</span>, by <span class="op">=</span> <span class="va">location</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">distance</span>, k <span class="op">=</span> <span class="fl">4</span>, by <span class="op">=</span> <span class="va">location</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">avg_wind_speed</span>, k <span class="op">=</span> <span class="fl">18</span>, by <span class="op">=</span> <span class="va">location</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">avg_temp</span>, k <span class="op">=</span> <span class="fl">18</span>, by <span class="op">=</span> <span class="va">location</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">avg_rh</span>, k <span class="op">=</span> <span class="fl">18</span>, by <span class="op">=</span> <span class="va">location</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">wind_direction</span>, k <span class="op">=</span> <span class="fl">18</span>, by <span class="op">=</span> <span class="va">location</span><span class="op">)</span> <span class="op">+</span>
      <span class="va">assessment_number</span> <span class="op">+</span>
      <span class="va">location</span> <span class="op">+</span>
      <span class="va">direc_loc</span>,
    data <span class="op">=</span> <span class="va">dat</span>,
    method <span class="op">=</span> <span class="st">"REML"</span>
  <span class="op">)</span></code></pre></div>
<pre><code>## Error in is.data.frame(data): object 'dat' not found</code></pre>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_9</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in summary(model_9): object 'model_9' not found</code></pre>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span>
  <span class="va">model_9</span>,
  pages <span class="op">=</span> <span class="fl">1</span>,
  shade <span class="op">=</span> <span class="cn">TRUE</span>,
  seWithMean <span class="op">=</span> <span class="cn">TRUE</span>,
  shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model_9</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="op">)</span></code></pre></div>
<pre><code>## Error in plot(model_9, pages = 1, shade = TRUE, seWithMean = TRUE, shift = coef(model_9)[1]): object 'model_9' not found</code></pre>
</div>
<div id="comments-on-model_9" class="section level3">
<h3 class="hasAnchor">
<a href="#comments-on-model_9" class="anchor"></a>Comments on model_9</h3>
<p>Fitting different smooths for each term by location in <code>model_9</code> improved the adjusted R^2 and percent deviance explained values. Noam Ross encourages this practice in his own words,</p>
<blockquote>
<p>“We can also specify a GAM formula that will fit different smooths for different categorical variables. We call this a factor-smooth interaction. By specifying the ‘by’ argument to the s() function, we can tell R to calculate a different smooth for each unique category. Usually, when we have smooth-factor interactions, we want to also include a varying intercept, in case the different categories are different in overall means in addition to shape of their smooths. Here, you see adding this varying intercept improves the estimate of the smooth. Usually, when we have smooth-factor interactions, we want to also include a varying intercept, in case the different categories are different in overall means in addition to shape of their smooths”</p>
</blockquote>
</div>
<div id="model_10" class="section level3">
<h3 class="hasAnchor">
<a href="#model_10" class="anchor"></a>Model_10</h3>
<p>Same as <code>model_8</code> but relative humidity, wind speed and wind direction removed, as they were not significant.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_10</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span><span class="op">(</span>
    <span class="va">incidence</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">total_rain</span>, k <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">distance</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">avg_wind_speed</span>, k <span class="op">=</span> <span class="fl">18</span><span class="op">)</span> <span class="op">+</span>
      <span class="va">location</span> <span class="op">+</span>
      <span class="va">assessment_number</span> <span class="op">+</span>
      <span class="va">direc_loc</span>,
    data <span class="op">=</span> <span class="va">dat</span>,
    method <span class="op">=</span> <span class="st">"REML"</span>
  <span class="op">)</span></code></pre></div>
<pre><code>## Error in is.data.frame(data): object 'dat' not found</code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_10</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in summary(model_10): object 'model_10' not found</code></pre>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/plot.html">plot</a></span><span class="op">(</span>
  <span class="va">model_10</span>,
  pages <span class="op">=</span> <span class="fl">1</span>,
  shade <span class="op">=</span> <span class="cn">TRUE</span>,
  seWithMean <span class="op">=</span> <span class="cn">TRUE</span>,
  shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model_10</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="op">)</span></code></pre></div>
<pre><code>## Error in plot(model_10, pages = 1, shade = TRUE, seWithMean = TRUE, shift = coef(model_10)[1]): object 'model_10' not found</code></pre>
</div>
</div>
<div id="compare-the-models" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-the-models" class="anchor"></a>Compare the models</h2>
<div id="aic-bic" class="section level3">
<h3 class="hasAnchor">
<a href="#aic-bic" class="anchor"></a>AIC, BIC</h3>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  model_1 <span class="op">=</span> <span class="va">model_1</span>,
  model_2 <span class="op">=</span> <span class="va">model_2</span>,
  model_3 <span class="op">=</span> <span class="va">model_3</span>,
  model_4 <span class="op">=</span> <span class="va">model_4</span>,
  model_5 <span class="op">=</span> <span class="va">model_5</span>,
  model_6 <span class="op">=</span> <span class="va">model_6</span>,
  model_6.1 <span class="op">=</span> <span class="va">model_6.1</span>,
  model_7 <span class="op">=</span> <span class="va">model_7</span>,
  model_8 <span class="op">=</span> <span class="va">model_8</span>,
  model_9 <span class="op">=</span> <span class="va">model_9</span>,
  model_10 <span class="op">=</span> <span class="va">model_10</span>
 <span class="op">)</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object 'model_1' not found</code></pre>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">map_df</span><span class="op">(</span><span class="va">models</span>, <span class="va">glance</span>, .id <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">arrange</span><span class="op">(</span><span class="va">AIC</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in map(.x, .f, ...): object 'models' not found</code></pre>
</div>
<div id="r2" class="section level3">
<h3 class="hasAnchor">
<a href="#r2" class="anchor"></a>R<sup>2</sup>
</h3>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">enframe</span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    model_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_1</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,
    model_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_2</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,
    model_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_3</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,
    model_4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_4</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,
    model_5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_5</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,
    model_6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_6</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,
    model_6.1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_6.1</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,
    model_7 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_7</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,
    model_8 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_8</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,
    model_9 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_9</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,
    model_10 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_10</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in summary(model_1): object 'model_1' not found</code></pre>
</div>
<div id="anova" class="section level3">
<h3 class="hasAnchor">
<a href="#anova" class="anchor"></a>ANOVA</h3>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span>
  <span class="va">model_1</span>,
  <span class="va">model_2</span>,
  <span class="va">model_3</span>,
  <span class="va">model_4</span>,
  <span class="va">model_5</span>,
  <span class="va">model_6</span>,
  <span class="va">model_6.1</span>,
  <span class="va">model_7</span>,
  <span class="va">model_8</span>,
  <span class="va">model_9</span>,
  <span class="va">model_10</span>
 <span class="op">)</span></code></pre></div>
<pre><code>## Error in anova(model_1, model_2, model_3, model_4, model_5, model_6, model_6.1, : object 'model_1' not found</code></pre>
</div>
</div>
<div id="perform-checks-on-the-best-fitting-model_9" class="section level2">
<h2 class="hasAnchor">
<a href="#perform-checks-on-the-best-fitting-model_9" class="anchor"></a>Perform checks on the best fitting <code>model_9</code>
</h2>
<div id="gam-check-and-concurvity" class="section level3">
<h3 class="hasAnchor">
<a href="#gam-check-and-concurvity" class="anchor"></a>gam.check and concurvity</h3>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.check.html">gam.check</a></span><span class="op">(</span><span class="va">model_9</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in residuals(b, type = type): object 'model_9' not found</code></pre>
</div>
<div id="comments-on-the-model-check" class="section level3">
<h3 class="hasAnchor">
<a href="#comments-on-the-model-check" class="anchor"></a>Comments on the model check</h3>
<p>The model has been fully converged, which indicates that there is no issue of too many variables for not enough data. However, the model fit could have been much better if we had enough basis function for predictors showing significant result in the diagnostic function, the low p value means residuals are not randomly distributed).</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/concurvity.html">concurvity</a></span><span class="op">(</span><span class="va">model_9</span>, full<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in concurvity(model_9, full = TRUE): object 'model_9' not found</code></pre>
</div>
</div>
<div id="final-thoughts" class="section level2">
<h2 class="hasAnchor">
<a href="#final-thoughts" class="anchor"></a>Final thoughts</h2>
<p>The <code>model_9</code> seems to be the best fit model and adequately describes the spatiotemporal development of Ascochyta blight of chickpea</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ihanul Khaliq, Grains Research and Development Corporation.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
